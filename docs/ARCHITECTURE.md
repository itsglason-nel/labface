System Architecture

LabFace follows a microservices architecture containerized with Docker.

Components

1. Frontend (Next.js)
-   Port: 3001
-   Role: User Interface for Students and Professors.
-   Tech: React, Tailwind CSS.
-   Communication: Calls Backend API via HTTP.

2. Backend (Node.js/Express)
-   Port: 5001
-   Role: Central business logic, authentication, and data management.
-   Tech: Express.js, MySQL2.
-   Communication: Connects to MariaDB and MinIO. Receives calls from Frontend and AI Service.

3. AI Service (Python/FastAPI)
-   Internal Only (No host port exposed to avoid conflicts, accessible via Docker network at http://ai-service:8000)
-   Role: Face Recognition and RTSP Stream Processing.
-   Tech: InsightFace, OpenCV, FastAPI.
-   Communication: Pulls RTSP streams (from cameras), sends attendance data to Backend API.

4. Database (MariaDB)
-   Port: 3307
-   Role: Persistent storage for Users, Classes, and Attendance logs.

5. Object Storage (MinIO)
-   Port: 9002 (API), 9003 (Console)
-   Role: Stores face registration images and attendance snapshots.

Data Flow

1.  Registration: User registers on Frontend -> Backend stores info in DB -> Face image sent to MinIO (and embedding generated by AI Service).
2.  Class Session: Professor starts session on Frontend -> Backend creates Session record.
3.  Attendance:
    -   AI Service continuously analyzes CCTV stream.
    -   Face detected -> Embedding generated -> Compared with DB records.
    -   Match found -> AI Service calls Backend /api/attendance/mark.
    -   Backend updates DB -> Frontend Dashboard updates in real-time (via polling or refresh).
